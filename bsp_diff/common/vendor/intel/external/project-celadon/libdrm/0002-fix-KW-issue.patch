From 551df5a5a9ebbcf017fa3f526f3de13b4941cd2d Mon Sep 17 00:00:00 2001
From: "Chen, Yu" <yu.y.chen@intel.com>
Date: Sat, 12 Mar 2022 16:40:50 +0800
Subject: [PATCH] fix KW issue

Tracked-On: OAM-101343
Signed-off-by: Chen, Yu <yu.y.chen@intel.com>
Change-Id: I34d8ba51c225778acc22216ace503f92b57386f8
---
 intel/intel_bufmgr_gem.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/intel/intel_bufmgr_gem.c b/intel/intel_bufmgr_gem.c
index b28ea74d..0d00492e 100644
--- a/intel/intel_bufmgr_gem.c
+++ b/intel/intel_bufmgr_gem.c
@@ -1735,6 +1735,8 @@ static int mmap_write(drm_intel_bo *bo, unsigned long offset,
 	}
 
 	assert(map);
+	if (NULL == map)
+		return -1;
 	memcpy((char *)map + offset, buf, length);
 	drm_intel_gem_bo_unmap(bo);
 	return 0;
@@ -1761,6 +1763,8 @@ static int mmap_read(drm_intel_bo *bo, unsigned long offset,
 	}
 
 	assert(map);
+	if (NULL == map)
+		return -1;
 	memcpy(buf, (char *)map + offset, length);
 	drm_intel_gem_bo_unmap(bo);
 	return 0;
-- 
2.33.1

